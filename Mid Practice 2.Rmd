---
title: "Transit Data"
author: "Shadman Tousif Khandoker"
output: html_document
---

# Load libraries
```{r}
library(forecast)
library(ggplot2)
library(readr)
library(tseries)
```

# 1. Import Data path
```{r}
TRANSIT <- read_csv("G:/R files/Another mid term project/TRANSIT.csv")
Transit_Raw <- TRANSIT$TRANSIT
Transit_ts <- ts(Transit_Raw, frequency = 12, start = c(2000,1))
```

# 2. Plot
```{r}
plot(Transit_ts, main = "US Public Transit Ridership (2000-2023)", 
     ylab = "Ridership", xlab = "Year")
```

# 3. Central Tendency
```{r}
summary(Transit_Raw)
boxplot(Transit_Raw, main = "Box Plot of Transit Ridership")
```

# 4. Decomposition
```{r}
decomp <- decompose(Transit_ts, type = "multiplicative")
plot(decomp)
```

# Seasonal indices
```{r}
seasonal_indices <- decomp$seasonal[1:12]
print(seasonal_indices)
```

# Seasonally adjusted data
```{r}
adjusted_ts <- Transit_ts / decomp$seasonal
plot(Transit_ts, col = "blue", main = "Actual vs Seasonally Adjusted")
lines(adjusted_ts, col = "red")
legend("topright", legend = c("Actual", "Adjusted"), col = c("blue", "red"), lty = 1)
```

# 5. Naive Method
```{r}
naive_model <- naive(Transit_ts, h = 12)
```

# Residual Analysis
```{r}
checkresiduals(naive_model)
```

# Accuracy measures
```{r}
accuracy(naive_model)
```

# Forecast
```{r}
plot(naive_model, main = "Naive Method Forecast")
print(naive_model$mean)
```

# 6. Simple Moving Averages
```{r}
par(mfrow = c(1,1))
plot(Transit_ts, main = "Moving Averages")
lines(ma(Transit_ts, 3), col = "red", lwd = 2)
lines(ma(Transit_ts, 6), col = "blue", lwd = 2)
lines(ma(Transit_ts, 9), col = "green", lwd = 2)
legend("topright", legend = c("Original", "MA(3)", "MA(6)", "MA(9)"),
       col = c("black", "red", "blue", "green"), lty = 1)
```

# 7. Simple Exponential Smoothing (SES)
```{r}
ses_model <- ses(Transit_ts, h = 12)
```

# Model parameters
```{r}
ses_model$model
```

# Residual Analysis
```{r}
checkresiduals(ses_model)
```

# Accuracy and Forecast
```{r}
accuracy(ses_model)
plot(ses_model, main = "Simple Exponential Smoothing Forecast")
```

# 8. Holt-Winters Method
```{r}
hw_model <- hw(Transit_ts, h = 12, seasonal = "multiplicative")
```

# Model parameters
```{r}
hw_model$model
```

# Residual Analysis
```{r}
checkresiduals(hw_model)
```

# Accuracy and Forecast
```{r}
accuracy(hw_model)
plot(hw_model, main = "Holt-Winters Forecast")
```

# 9. Accuracy Summary
```{r}
accuracy_compare <- rbind(
  accuracy(naive_model),
  accuracy(ses_model),
  accuracy(hw_model)
)
rownames(accuracy_compare) <- c("Naive", "SES", "Holt-Winters")
print(accuracy_compare)
```

# Best model based on RMSE
```{r}
best_model <- which.min(accuracy_compare[,"RMSE"])
cat("Best model:", rownames(accuracy_compare)[best_model], "\n")
```

# 10. Conclusion
```{r}
cat("Final Analysis:\n")
cat("- Pre-pandemic: Stable ridership with seasonal patterns (between 800K-950K)\n")
cat("- Pandemic impact: Dramatic drop by 80% in April 2020\n") 
cat("- Recovery: Gradual but incomplete, currently about 60% of pre-pandemic levels\n")
cat("- Forecast: Continued slow recovery over next 1-2 years\n")
cat("- Holt-Winters predicts values between 550K-650K for next year\n")
```

